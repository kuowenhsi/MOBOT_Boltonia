mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, flowerRatio == 0 ~ 0, flowerRatio >= 1 ~ 1, TRUE ~ as.numeric(NA)))
Boltonia_data_FlowerRatio <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name) %>%
summarize(flowerRatio = sum(values)/n()) %>%
ungroup() %>%
complete(Date, variable_name) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio))
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(group = variable_name, fill = variable.names()))+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank())
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 4, height = 4)
Boltonia_data_FlowerRatio <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name) %>%
summarize(flowerRatio = sum(values)/n()) %>%
ungroup() %>%
complete(Date, variable_name) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio), Date = as.Date(Date))
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(group = variable_name, fill = variable.names()))+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank())
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 4, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(group = variable_name, fill = variable_name))+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank())
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 4, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(group = variable_name, fill = variable_name), position = position_dodge())+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank())
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 4, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(fill = variable_name))+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
facet_wrap(.~variable_name)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank())
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 4, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(fill = variable_name))+
scale_y_continuous(name = "Total flower ratio (disk flower open)", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
facet_wrap(.~variable_name)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 10, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(fill = variable_name))+
scale_y_continuous(name = "Total flower ratio", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
facet_wrap(.~variable_name)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 10, height = 4)
Boltonia_data_FlowerRatio_county <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name, County) %>%
summarize(flowerRatio = sum(values)/n(), mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))%>%
ungroup() %>%
complete(Date, variable_name, County) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio), Date = as.Date(Date))
View(Boltonia_data_FlowerRatio_county)
Boltonia_data_county_coordinations <- Boltonia_data %>%
group_by(County)%>%
summarize(mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))
View(Boltonia_data_FlowerRatio)
View(Boltonia_data_county_coordinations)
Boltonia_data_FlowerRatio_county <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name, County) %>%
summarize(flowerRatio = sum(values)/n())%>%
ungroup() %>%
complete(Date, variable_name, County) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio), Date = as.Date(Date))
Boltonia_data_FlowerRatio_county <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name, County) %>%
summarize(flowerRatio = sum(values)/n())%>%
ungroup() %>%
complete(Date, variable_name, County) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio), Date = as.Date(Date))%>%
left_join(Boltonia_data_county_coordinations, by = "County")
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
facet_wrap(.~variable_name)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col()+
facet_wrap(.~County, nrow = 3)
p
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
p
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_fill_brewer(palette = "PiYG")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 4)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_fill_distiller(palette = "PiYG")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 4)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_fill_distiller(palette = "Set1")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 4)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_fill_distiller(palette = "Set1")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_fill_brewer(palette = "Set1")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(palette = "Set1")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(palette = "Set2")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(palette = "Set3")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(palette = "Set4")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(palette = "Spectral")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(name = "", palette = "Spectral")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_discrete(name = "")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col()+
facet_wrap(.~County)
p
geom_col(aes(fill = as.character(Date))+
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
facet_wrap(.~County)
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
p
# buds
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
p
# buds
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "bottom")
p
# buds
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
# buds
p <- ggplot(data = (Boltonia_data_FlowerRatio_county, variable_name = "numFlwrB"), aes(x = Date, y = flowerRatio))+
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name = "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~County, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(County, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(County, mean_Google_latitude), nrow = 3)+
ggtitle("County arranged by latitude")+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
?labeller
Boltonia_data_county_coordinations <- Boltonia_data %>%
group_by(County)%>%
summarize(mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))%>%
arrange(mean_Google_latitude)
Boltonia_data_county_coordinations <- Boltonia_data %>%
group_by(County)%>%
summarize(mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))%>%
arrange(mean_Google_latitude)%>%
mutate(labels = paste0(County, "\n", "(", round(mean_Google_latitude, 2), ", ", round(mean_Google_longitude, 2, ")")))
?round
Boltonia_data_county_coordinations <- Boltonia_data %>%
group_by(County)%>%
summarize(mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))%>%
arrange(mean_Google_latitude)%>%
mutate(labels = paste0(County, "\n", "(", round(mean_Google_latitude, 2), ", ", round(mean_Google_longitude, 2), ")")))
Boltonia_data_county_coordinations <- Boltonia_data %>%
group_by(County)%>%
summarize(mean_Google_latitude = mean(Google_Latitude), mean_Google_longitude = mean(Google_Longitude))%>%
arrange(mean_Google_latitude)%>%
mutate(labels = paste0(County, "\n", "(", round(mean_Google_latitude, 2), ", ", round(mean_Google_longitude, 2), ")"))
Boltonia_data_FlowerRatio_county <- Boltonia_data %>%
filter(variable_name %in% c("numFlwrB", "numRayF", "numDiscF")) %>%
mutate(Date = factor(Date)) %>%
mutate(values = case_when(is.na(values) ~ 0, values == 0 ~ 0, values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date, variable_name, County) %>%
summarize(flowerRatio = sum(values)/n())%>%
ungroup() %>%
complete(Date, variable_name, County) %>%
mutate(flowerRatio = case_when(is.na(flowerRatio) ~ 0, TRUE ~ flowerRatio), Date = as.Date(Date))%>%
left_join(Boltonia_data_county_coordinations, by = "County")
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
p
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_bud_ratio_by_county.png", width = 10, height = 10)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_discrete(name = "")+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# Ray
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numRayF"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower ray flower ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_ray_ratio_by_county.png", width = 10, height = 10)
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numDiscF"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_disk_ratio_by_county.png", width = 10, height = 10)
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, variable_name == "numDiscF"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower disc ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_disk_ratio_by_county.png", width = 10, height = 10)
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
facet_wrap(.~variable_name, nrow = 3)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
stat_smooth(method = "lm", color = "blue")+
stat_cor(method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), color = "red")
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
scale_y_continuous(name = "Days to flower")+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
ggsave("./figures/Boltonia_days_to_flower_by_latitude.png", width = 10, height = 6)
ggsave("./figures/Boltonia_days_to_flower_by_latitude.png", width = 13, height = 5)
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_longitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
scale_y_continuous(name = "Days to flower")+
facet_wrap(.~variable_name, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
ggsave("./figures/Boltonia_days_to_flower_by_longitude.png", width = 13, height = 5)
View(Boltonia_data)
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County)%>%
summarize()
View(Boltonia_data_rep)
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County)%>%
summarize(rep = n())
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead)%>%
summarize(rep = n())
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead)%>%
summarize()
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead, index)%>%
summarize()
View(Boltonia_data_rep)
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead, index)%>%
summarize()%>%
group_by(MaternalLine, County, FlowerHead)%>%
summarise(rep = n())
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead, index)%>%
summarize()%>%
group_by(MaternalLine)%>%
summarise(rep = n())
Boltonia_data_rep <- Boltonia_data %>%
group_by(MaternalLine, County, FlowerHead, index)%>%
summarize()%>%
group_by(MaternalLine, County, FlowerHead)%>%
summarise(rep = n())
