select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))%>%
complete(Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))%>%
complete(index,Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))%>%
select(index, num_traits, DaysToFlower)%>%
complete(index,Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))%>%
select(index, num_traits, DaysToFlower)%>%
complete(index, Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
mutate(Date = factor(Date, labels = sort(unique(Date))))%>%
select(index, Date, num_traits, DaysToFlower)%>%
complete(index, Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(index = as.factor(index))%>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)
Boltonia_data_DaysToFlower
Boltonia_data_DaysToFlower$index
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(index = as.factor(index))%>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)%>%
complete(index, Date, num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(index = as.factor(index))%>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)%>%
complete(index, num_traits)
Boltonia_data_DaysToFlower
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(index = as.factor(index))%>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)%>%
complete(index, num_traits)%>%
mutate(DaysToFlower = case_when(is.na(DaysToFlower) ~ as.difftime(150, "%d", "days"), TRUE ~ DaysToFlower))%>%
mutate(index = as.integer(index)) %>%
left_join(read_csv("./data/Boltonia_merged_data_20240627.csv") %>% select(1:12), by = "index", relationship = "many-to-many")
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(fill = num_traits))+
scale_y_continuous(name = "Total flower ratio", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
facet_wrap(.~num_traits)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 10, height = 4)
p <- ggplot(data = Boltonia_data_FlowerRatio, mapping = aes(x = Date, y = flowerRatio)) +
geom_col(aes(fill = num_traits))+
scale_y_continuous(name = "Total flower ratio", limits = c(0, 1), expand = c(0, 0, 0, 0))+
scale_x_date(name = "", breaks = unique(Boltonia_data_FlowerRatio$Date), date_labels = "%b %d")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_flower_ratio.png", width = 8, height = 12)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = as.character(Date), fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_discrete(name = "")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
View(Boltonia_data_FlowerRatio_county)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(fill = as.character(Date)), position = position_dodge())+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_x_discrete(name = "")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(fill = Date), position = position_dodge())+
scale_fill_distiller(name = "", palette = "Spectral")+
scale_x_discrete(name = "")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_x_discrete(name = "")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
?scale_fill_date
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_x_discrete(name = "")+
scale_fill_date(low = "yellow", high = "red")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom")
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
?legend.key.width
??legend.key.width
?theme
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_x_discrete(name = "")+
scale_fill_date(low = "yellow", high = "red")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom", legend.key.width = unit(5, "in") )
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# County first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = reorder(labels, mean_Google_latitude), y = flowerRatio))+
geom_col(aes(group = Date, fill = Date), position = position_dodge())+
scale_x_discrete(name = "")+
scale_fill_date(low = "yellow", high = "red")+
facet_wrap(.~num_traits, nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid.minor = element_blank(), legend.position = "bottom", legend.key.width = unit(1, "in") )
ggsave("./figures/Boltonia_total_flower_ratio_by_county.png", width = 10, height = 6)
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, num_traits == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_fill_brewer(name = "", palette = "Spectral")+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_bud_ratio_by_county.png", width = 10, height = 10)
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, num_traits == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(==Date)))+
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, num_traits == "numFlwrB"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_y_continuous(name = "Flower bud ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_bud_ratio_by_county.png", width = 10, height = 10)
# Ray
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, num_traits == "numRayF"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_y_continuous(name = "Flower ray flower ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_ray_ratio_by_county.png", width = 10, height = 10)
# buds
p <- ggplot(data = filter(Boltonia_data_FlowerRatio_county, num_traits == "numDiscF"), aes(x = Date, y = flowerRatio))+
geom_col(aes(fill = as.character(Date)))+
scale_y_continuous(name = "Flower disc ratio")+
scale_x_date(name = "")+
facet_wrap(.~reorder(labels, mean_Google_latitude), nrow = 3)+
theme_bw()+
theme(axis.text.x = element_text(angle = 45, vjust = 0.5), panel.grid = element_blank(), legend.position = "none")
ggsave("./figures/Boltonia_total_disk_ratio_by_county.png", width = 10, height = 10)
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
scale_y_continuous(name = "Days to flower")+
facet_wrap(.~num_traits, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
ggsave("./figures/Boltonia_days_to_flower_by_latitude.png", width = 13, height = 5)
View(Boltonia_data_DaysToFlower)
unique(Boltonia_data_DaysToFlower$num_traits)
Boltonia_data_DaysToFlower <- Boltonia_data %>%
mutate(index = as.factor(index))%>%
mutate(PlantingDate = as.Date(PlantingDate, "%m/%d/%y"), FirstLeafDate = as.Date(FirstLeafDate, "%m/%d/%y"))%>%
filter(num_traits %in% c("numFlwrB", "numRayF", "numDiscF"))%>%
mutate(num_values = case_when(is.na(num_values) ~ 0, TRUE ~ num_values))%>%
group_by(index, num_traits)%>%
arrange(Date, .by_group = TRUE)%>%
mutate(is_first = case_when((lag(num_values) == 0 & num_values > 0) ~ TRUE, TRUE ~ FALSE))%>%
filter(is_first == TRUE)%>%
filter(Date == min(Date))%>%
select(index, PlantingDate, FirstLeafDate, num_traits, Date)%>%
mutate(DaysToFlower = Date -PlantingDate)%>%
ungroup()%>%
select(index, num_traits, DaysToFlower)%>%
complete(index, num_traits)%>%
mutate(DaysToFlower = case_when(is.na(DaysToFlower) ~ as.difftime(150, "%d", "days"), TRUE ~ DaysToFlower))%>%
mutate(index = as.integer(index), num_traits = factor(num_traits, levels = c("numFlwrB", "numRayF", "numDiscF"))) %>%
left_join(read_csv("./data/Boltonia_merged_data_20240627.csv") %>% select(1:12), by = "index", relationship = "many-to-many")
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_latitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
scale_y_continuous(name = "Days to flower")+
facet_wrap(.~num_traits, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
ggsave("./figures/Boltonia_days_to_flower_by_latitude.png", width = 13, height = 5)
p <- ggplot(data = Boltonia_data_DaysToFlower, aes(x = Google_longitude, y = as.integer(DaysToFlower)))+
geom_point()+
geom_point(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) == 150), color = "red")+
stat_smooth(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150), method = "lm", color = "blue")+
stat_cor(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(data = filter(Boltonia_data_DaysToFlower, as.integer(DaysToFlower) < 150),label.x.npc = 0, label.y.npc = 0.95)+
scale_y_continuous(name = "Days to flower")+
facet_wrap(.~num_traits, nrow = 1)+
theme_bw()+
theme(panel.grid.minor = element_blank(), legend.position = "bottom")
p
ggsave("./figures/Boltonia_days_to_flower_by_longitude.png", width = 13, height = 5)
# Date first
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = as.character(Date), y = flowerRatio))+
geom_col(aes(group = County, fill = County), position = position_dodge())
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, aes(x = County, y = flowerRatio))+
geom_col()+
facet_wrap(.~Date)+
theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5))
p
p <- ggplot(data = Boltonia_data_FlowerRatio_county, mapping = aes(x = mean_Google_latitude, y = flowerRatio))+
geom_point()+
stat_smooth(method = "lm", color = "blue")+
stat_cor(method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~Date)+
theme_bw()
p
# Then plot flowering ratio by Date and MaternalLine
Boltonia_data_FlowerRatio <- Boltonia_data %>%
filter(num_traits == "numDiscF", MaternalLine == "2011-2598-1") %>%
mutate(num_values = case_when(is.na(num_values) ~ 0, num_values == 0 ~ 0, num_values >= 1 ~ 1, TRUE ~ as.numeric(NA))) %>%
group_by(Date) %>%
summarize(flowerRatio = sum(num_values)/n())
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength", Date == as.Date("2024-06-19")), aes(x = County, y = num_values))+
geom_point()+
labs(title = "County & Stem Length")
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = County, y = num_values))+
geom_point()+
labs(title = "County & Stem Length")+
facet_wrap(.~County)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_point()+
labs(title = "County & Stem Length")+
facet_wrap(.~County)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_point()+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x")
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_point()+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 1)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = Date))+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 1)
p
filter(Boltonia_data, num_traits == "stemLength")
View(Boltonia_data)
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = Date, fill = MaternalLine))+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 2)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = Date, fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 2)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = MaternalLine, fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 2)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = Date, fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 2)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_wrap(.~County, scales = "free_x", nrow = 2)
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_grid(.~County, scales = "free_x", nrow = 2)
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_grid(.~County, scales = "free_x")
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_grid(.~County, scales = "free_x", space = "free_x")
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
facet_grid(.~County, scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
facet_grid(.~County, scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
facet_grid(.~County, scales = "free_x", space = "free_x", rows = 2)+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
p
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
facet_grid(.~County, scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
p
ggsave("./figures/County_stemlength.png", width = 20, height = 8, dpi = 600)
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
scale_y_continuous("Stem Length (cm)")+
facet_grid(.~County, scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
ggsave("./figures/County_stemlength.png", width = 30, height = 8, dpi = 600)
View(Boltonia_data)
View(Boltonia_data_county_coordinations)
View(Boltonia_data)
Boltonia_data_CountyLabels <- Boltonia_data %>%
left_join(Boltonia_data_county_coordinations, by = "County")
p <- ggplot(data = filter(Boltonia_data_CountyLabels, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
scale_y_continuous("Stem Length (cm)")+
facet_grid(.~County, scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
ggsave("./figures/County_stemlength.png", width = 30, height = 8, dpi = 600)
View(Boltonia_data_CountyLabels)
p <- ggplot(data = filter(Boltonia_data_CountyLabels, num_traits == "stemLength"), aes(x = MaternalLine, y = num_values))+
geom_boxplot(aes(group = paste(Date, MaternalLine), fill = MaternalLine), position = position_dodge())+
labs(title = "County & Stem Length")+
scale_x_discrete("Accession (Site)")+
scale_y_continuous("Stem Length (cm)")+
facet_grid(~reorder(labels, mean_Google_latitude), scales = "free_x", space = "free_x")+
theme(legend.position = "none", axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
ggsave("./figures/County_stemlength.png", width = 30, height = 8, dpi = 600)
p <- ggplot(data = Boltonia_data_FlowerRatio_county, mapping = aes(x = mean_Google_latitude, y = flowerRatio))+
geom_point()+
stat_smooth(method = "lm", color = "blue")+
stat_cor(method = "pearson", label.x.npc = 0, label.y.npc = 0.80)+
stat_regline_equation(label.x.npc = 0, label.y.npc = 0.95)+
facet_wrap(.~Date)+
theme_bw()
p
##MaternalLine plots#######
###########################
p <- ggplot(data = filter(Boltonia_data, num_traits == "stemLength", Date == as.Date("2024-06-19")), aes(x = MaternalLine, y = num_values))+
geom_point()+
labs(title = "Maternal Line & Stem Length")
p
